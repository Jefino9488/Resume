name: Compile LaTeX and Release Resume

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Install LaTeX packages
        run: |
          sudo apt-get update
          sudo apt-get install -y \
            texlive-latex-recommended \
            texlive-latex-extra \
            texlive-fonts-recommended \
            texlive-fonts-extra \
            latexmk

      - name: Compile main.tex
        run: |
          latexmk -pdf -interaction=nonstopmode main.tex
          mv main.pdf resume.pdf

      - name: Create GitHub Release with resume.pdf
        uses: ncipollo/release-action@v1
        with:
          tag: v1.0.0
          name: Resume v1.0.0
          files: resume.pdf